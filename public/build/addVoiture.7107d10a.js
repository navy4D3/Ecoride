"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[468],{902:(e,t,n)=>{n.d(t,{T8:()=>a,d8:()=>u});var o=n(28);function c(){var e=document.getElementById("add_voiture_marque"),t=document.getElementById("suggestions-marque-box"),n=JSON.parse(e.dataset.marqueList);e.addEventListener("input",(function(){var o=this.value.toLowerCase(),c=n.filter((function(e){return e.toLowerCase().includes(o)})).slice(0,10);t.innerHTML="",""!==o&&c.forEach((function(n){var o=document.createElement("li");o.textContent=n,o.style.cursor="pointer",o.onclick=function(){e.value=n,t.innerHTML=""},t.appendChild(o)}))}))}function r(e,t){var n=document.getElementById("add-voiture-section"),a=document.getElementById("add-voiture-form"),d=a.querySelectorAll("input, select, textarea");(0,o.checkInputs)(a),d.forEach((function(e){e.addEventListener("input",(function(){return(0,o.checkInputs)(a)}))})),document.getElementById("add-voiture-back-btn").addEventListener("click",(function(t){document.getElementById("add-voiture-section").style.display="none",document.getElementById(e).style.display="flex"})),document.getElementById("add_voiture_immatriculation").addEventListener("keydown",(function(e){" "===e.key&&e.preventDefault()}));var s=document.getElementById("add_voiture_couleur"),i=document.getElementById("color-view"),l={Blanc:"#ffffff",Noir:"#000000","Gris foncé":"#555555","Gris clair":"#d3d3d3",Rouge:"#ff0000",Bleu:"#0000ff",Vert:"#008000",Jaune:"#ffff00",Orange:"#ffa500",Marron:"#8b4513",Violet:"#800080",Beige:"#f5f5dc",Rose:"#ffc0cb"};function m(){var e=s.value;""===e?s.classList.add("select-color-placeholder"):s.classList.remove("select-color-placeholder"),i.style.backgroundColor=l[e]||"transparent"}s.addEventListener("change",m),m();var v=document.getElementById("add_voiture_places");v.addEventListener("input",(function(){var e=parseInt(this.value,10);isNaN(e)||(e<2?v.value=2:e>9&&(v.value=9))}));var f=document.getElementById("show-delete-voiture-popup");if(f){var p=document.getElementById("delete-voiture-popup"),h=document.getElementById("delete-voiture"),E=document.getElementById("add-voiture-form");f.addEventListener("click",(function(){(0,o.showPopup)(p,"flex")})),h.addEventListener("click",(function(c){c.preventDefault(),fetch("delete-voiture/"+t,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(c){c.status&&"success"==c.status?(document.getElementById(e).style.display="flex",document.getElementById(t).remove(),n.style.display="none",(0,o.showSuccessAlert)("Voiture supprimé avec succès"),u(e,t)):((0,o.treatFormAlert)(E,"",c),(0,o.hidePopup)(p))}))}))}document.getElementById("add-voiture-submit").addEventListener("click",(function(n){n.preventDefault(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-form"),a=new FormData(n),d=document.getElementById("add-voiture-section"),s=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(s,{method:"POST",body:a,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(n){if(n.status&&"success"==n.status){document.getElementById(e).style.display="flex",d.style.display="none";var a=document.getElementById("user-voitures");if(t){document.getElementById(t).innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),(0,o.showSuccessAlert)("Voiture modifié avec succès")}else{var s=document.createElement("div");s.classList.add("voiture-card"),s.id=n.voiture.id,s.innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),a.insertAdjacentElement("afterbegin",s),(0,o.showSuccessAlert)("Voiture ajouté avec succès")}u(e,t);var i=document.getElementById("devenir_chauffeur_hasVoiture"),l=document.querySelectorAll(".voiture-card");i&&l.length>0&&(i.checked=!0,i.dispatchEvent(new Event("input",{bubbles:!0})))}else{var m=document.getElementById("body-content");d.remove(),m.insertAdjacentHTML("beforeend",n.html),r(e,t),c()}}))}(e,t)}))}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.querySelectorAll(".voiture-card"),o=document.querySelector(".voiture-input");t||n.forEach((function(t){"true"!==t.dataset.listenerAttached&&t.addEventListener("click",(function(c){c.preventDefault();var r=t.id;n.forEach((function(e){return e.classList.remove("selected")})),this.classList.add("selected"),o.value=r;var u=new Event("input",{bubbles:!0});o.dispatchEvent(u),window.location.href.includes("publier-trajet")||a(e,t.id),t.dataset.listenerAttached="true"}))}))}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-section");n&&n.remove(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(n,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(n){if(e){document.getElementById(e).style.display="none";var o=document.getElementById("body-content");if(o){if(o.insertAdjacentHTML("beforeend",n.html),c(),r(e,t),t){var u=document.getElementById(t);document.getElementById("add_voiture_marque").value=u.querySelector(".marque").innerHTML}}else console.error("Le container cible n'existe pas : body-content")}})).catch((function(e){return console.error("Erreur:",e)}))}(e,t)}}},e=>{e.O(0,[264,28],(()=>{return t=902,e(e.s=t);var t}));e.O()}]);