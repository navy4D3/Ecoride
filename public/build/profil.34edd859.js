"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[53,468],{115:(e,t,n)=>{function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=document.querySelectorAll(".preference"),n=document.getElementById("devenir_chauffeur_preferences");e.length&&e.forEach((function(e){document.getElementById(e).classList.add("active")})),n.value=e.length?JSON.stringify(e):"",t.forEach((function(t){t.addEventListener("click",(function(r){r.preventDefault(),this.classList.toggle("active");var c=e.indexOf(t.id);-1===c?e.push(t.id):e.splice(c,1),n.value=e.length?JSON.stringify(e):"",n.dispatchEvent(new Event("input",{bubbles:!0}))}))}))}n.d(t,{D:()=>r})},889:(e,t,n)=>{var r=n(816),c=n.n(r),o=n(902),s=n(115),i=n(28),a=i.checkInputs,d=(i.showErrors,i.showSuccessAlert,i.treatFormAlert),u=i.checkPasswordValidity,l=i.checkRegisterFormValidity,m=(document.getElementById("trajets"),document.getElementById("mes-informations"),document.getElementById("parametres"),document.querySelector(".trajet-section"),document.querySelector(".my-data-section"),document.querySelector(".espace-chauffeur-section")),f=document.querySelector(".profil-navbar").querySelectorAll("div");f.forEach((function(e){e.addEventListener("click",(function(){if("espace-chauffeur"!=e.id||""!=e.dataset.isChauffeur){f.forEach((function(e){e.classList.remove("selected")}));var t=document.querySelector(".current-section");t.style.display="none",t.classList.toggle("current-section");var n=document.getElementById("add-voiture-section");n&&"flex"==n.style.display&&(n.style.display="none");var r=document.querySelector(".".concat(this.id,"-section"));r.style.display="flex",r.classList.toggle("current-section"),this.classList.add("selected")}else window.location.href="/devenir-chauffeur"}))}));var v=document.getElementById("edit-profil-icon"),p=document.getElementById("registration_step_two_photo_profil"),y=document.getElementById("my-data-form");function h(e){var t=e.querySelectorAll("input, select, textarea"),n=e.querySelector(".submit-btn");t.forEach((function(e){e.addEventListener("input",(function(){n.classList.remove("inactive")}))}))}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return new Promise((function(r,c){var o=new Image,s=new FileReader;s.onload=function(e){o.src=e.target.result},o.onload=function(){var e=t/o.width,s=Math.min(o.width,t),i=o.height*e,a=document.createElement("canvas");a.width=s,a.height=i,a.getContext("2d").drawImage(o,0,0,s,i),a.toBlob((function(e){e?r(e):c(new Error("Compression de l'image a échoué"))}),"image/jpeg",n)},s.onerror=function(e){return c(e)},s.readAsDataURL(e)}))}h(y),v.addEventListener("click",(function(){p.click()})),p.addEventListener("change",(function(){var e=document.getElementById("profil-picture-img");e.style.opacity="75%",v.style.display="none",g.classList.add("inactive");var t=this.files[0];if(t){var n=t.type.toLowerCase();"image/heic"===n||"image/heif"===n?c()({blob:t,toType:"image/jpeg",quality:.5}).then((function(e){return E(e,1024,.5)})).then(r).then((function(){e.style.opacity="100%",v.style.display="block",g.classList.remove("inactive")})).catch(console.error):E(t,1024,.5).then(r).then((function(){e.style.opacity="100%",v.style.display="block",g.classList.remove("inactive")})).catch(console.error)}function r(e){var n=URL.createObjectURL(e);document.getElementById("profil-picture-img").src=n;var r=new File([e],t.name.replace(/\.[^/.]+$/,"")+".jpg",{type:"image/jpeg"}),c=new DataTransfer;c.items.add(r),p.files=c.files}}));var g=document.getElementById("submit-my-data-form-btn");g.addEventListener("click",(function(e){g.classList.add("inactive");var t=new FormData(y);e.preventDefault(),fetch("/user/update-data",{method:"POST",body:t,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(e){d(y,"Données mises à jour avec succès",e)})).catch((function(e){return console.error("Erreur:",e)}))}));var L=document.getElementById("espace-chauffeur"),b=document.getElementById("devenir-chauffeur-form"),w=b.querySelector(".submit-btn");h(b);var I=!1;L.addEventListener("click",(function(){var e=document.querySelector(".preferences-list").dataset.userPreferences,t=""!==e?e.split(","):[];I||((0,s.D)(t),I=!0)})),w.addEventListener("click",(function(e){w.classList.add("inactive");var t=new FormData(b);e.preventDefault(),fetch("/user/update-chauffeur-data",{method:"POST",body:t,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(e){d(b,"Informations modifiés avec succès",e)})).catch((function(e){return console.error("Erreur:",e)}))}));var q=document.querySelectorAll(".voiture-card"),B=document.getElementById("add-voiture-btn");q.forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault(),(0,o.T8)(m.id,e.id)})),e.dataset.listenerAttached="true"})),B.addEventListener("click",(function(e){e.preventDefault(),(0,o.T8)(m.id)}));var S=document.querySelector(".parametres-section"),k=document.querySelector(".parametres-section-avis"),_=document.querySelector(".parametres-section-mail-password"),T=document.querySelector(".parametres-section-btns"),R=document.getElementById("avis-btn"),j=document.getElementById("mail-and-password-btn");R.addEventListener("click",(function(){k.style.display="flex",T.style.display="none"})),j.addEventListener("click",(function(){_.style.display="flex",T.style.display="none"})),S.querySelectorAll(".back-btn").forEach((function(e){e.addEventListener("click",(function(){e.parentElement.parentElement.style.display="none",T.style.display="flex"}))}));var A=document.getElementById("avis-recus-btn"),x=document.getElementById("avis-publies-btn"),D=k.querySelector(".avis-recus-section"),H=k.querySelector(".avis-publies-section");A.addEventListener("click",(function(){H.style.display="none",D.style.display="flex",A.classList.add("selected"),x.classList.remove("selected")})),x.addEventListener("click",(function(){D.style.display="none",H.style.display="flex",A.classList.remove("selected"),x.classList.add("selected")}));var M=document.getElementById("show-edit-mail-form-btn"),O=document.querySelector(".parametres-section-mail");M.addEventListener("click",(function(){O.style.display="flex",_.style.display="none"}));var P=document.querySelector(".edit-mail-form"),X=P.querySelector(".submit-btn");P.querySelectorAll("input, select, textarea").forEach((function(e){e.addEventListener("input",(function(){a(P)}))})),X.addEventListener("click",(function(e){e.preventDefault(),X.classList.add("inactive");var t=new FormData(P);fetch("/edit-mail",{method:"POST",body:t,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur réseau");return e.json()})).then((function(e){d(P,"Informations mises à jour avec succès",e),P.reset();new Event("input",{bubbles:!0})})).catch((function(e){return console.error("Erreur:",e)}))}));var C=document.getElementById("show-edit-password-form-btn"),F=document.querySelector(".parametres-section-password");C.addEventListener("click",(function(){F.style.display="flex",_.style.display="none"}));var V=document.querySelector(".edit-password-form"),W=document.getElementById("edit_password_password_first"),N=document.getElementById("edit_password_password_second"),U=document.getElementById("edit_password_currentPassword"),J=V.querySelector(".submit-btn");U.addEventListener("input",(function(){l(V,W,N,null,U)})),W.addEventListener("input",(function(){u("edit_password_password_first"),l(V,W,N,null,null,U)})),N.addEventListener("input",(function(){u("edit_password_password_first"),l(V,W,N,null,null,U)})),J.addEventListener("click",(function(e){e.preventDefault(),J.classList.add("inactive");var t=new FormData(V);fetch("/edit-password",{method:"POST",body:t,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur réseau");return e.json()})).then((function(e){d(V,"Informations mises à jour avec succès",e),V.reset();var t=new Event("input",{bubbles:!0});W.dispatchEvent(t)})).catch((function(e){return console.error("Erreur:",e)}))}))},902:(e,t,n)=>{n.d(t,{T8:()=>i,d8:()=>s});var r=n(28);function c(){var e=document.getElementById("add_voiture_marque"),t=document.getElementById("suggestions-marque-box"),n=JSON.parse(e.dataset.marqueList);e.addEventListener("input",(function(){var r=this.value.toLowerCase(),c=n.filter((function(e){return e.toLowerCase().includes(r)})).slice(0,10);t.innerHTML="",""!==r&&c.forEach((function(n){var r=document.createElement("li");r.textContent=n,r.style.cursor="pointer",r.onclick=function(){e.value=n,t.innerHTML=""},t.appendChild(r)}))}))}function o(e,t){var n=document.getElementById("add-voiture-section"),i=document.getElementById("add-voiture-form"),a=i.querySelectorAll("input, select, textarea");(0,r.checkInputs)(i),a.forEach((function(e){e.addEventListener("input",(function(){return(0,r.checkInputs)(i)}))})),document.getElementById("add-voiture-back-btn").addEventListener("click",(function(t){document.getElementById("add-voiture-section").style.display="none",document.getElementById(e).style.display="flex"})),document.getElementById("add_voiture_immatriculation").addEventListener("keydown",(function(e){" "===e.key&&e.preventDefault()}));var d=document.getElementById("add_voiture_couleur"),u=document.getElementById("color-view"),l={Blanc:"#ffffff",Noir:"#000000","Gris foncé":"#555555","Gris clair":"#d3d3d3",Rouge:"#ff0000",Bleu:"#0000ff",Vert:"#008000",Jaune:"#ffff00",Orange:"#ffa500",Marron:"#8b4513",Violet:"#800080",Beige:"#f5f5dc",Rose:"#ffc0cb"};function m(){var e=d.value;""===e?d.classList.add("select-color-placeholder"):d.classList.remove("select-color-placeholder"),u.style.backgroundColor=l[e]||"transparent"}d.addEventListener("change",m),m();var f=document.getElementById("add_voiture_places");f.addEventListener("input",(function(){var e=parseInt(this.value,10);isNaN(e)||(e<2?f.value=2:e>9&&(f.value=9))}));var v=document.getElementById("show-delete-voiture-popup");if(v){var p=document.getElementById("delete-voiture-popup"),y=document.getElementById("delete-voiture"),h=document.getElementById("add-voiture-form");v.addEventListener("click",(function(){(0,r.showPopup)(p,"flex")})),y.addEventListener("click",(function(c){c.preventDefault(),fetch("delete-voiture/"+t,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(c){c.status&&"success"==c.status?(document.getElementById(e).style.display="flex",document.getElementById(t).remove(),n.style.display="none",(0,r.showSuccessAlert)("Voiture supprimé avec succès"),s(e,t)):((0,r.treatFormAlert)(h,"",c),(0,r.hidePopup)(p))}))}))}document.getElementById("add-voiture-submit").addEventListener("click",(function(n){n.preventDefault(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-form"),i=new FormData(n),a=document.getElementById("add-voiture-section"),d=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(d,{method:"POST",body:i,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(n){if(n.status&&"success"==n.status){document.getElementById(e).style.display="flex",a.style.display="none";var i=document.getElementById("user-voitures");if(t){document.getElementById(t).innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),(0,r.showSuccessAlert)("Voiture modifié avec succès")}else{var d=document.createElement("div");d.classList.add("voiture-card"),d.id=n.voiture.id,d.innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),i.insertAdjacentElement("afterbegin",d),(0,r.showSuccessAlert)("Voiture ajouté avec succès")}s(e,t);var u=document.getElementById("devenir_chauffeur_hasVoiture"),l=document.querySelectorAll(".voiture-card");u&&l.length>0&&(u.checked=!0,u.dispatchEvent(new Event("input",{bubbles:!0})))}else{var m=document.getElementById("body-content");a.remove(),m.insertAdjacentHTML("beforeend",n.html),o(e,t),c()}}))}(e,t)}))}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.querySelectorAll(".voiture-card"),r=document.querySelector(".voiture-input");t||n.forEach((function(t){"true"!==t.dataset.listenerAttached&&t.addEventListener("click",(function(c){c.preventDefault();var o=t.id;n.forEach((function(e){return e.classList.remove("selected")})),this.classList.add("selected"),r.value=o;var s=new Event("input",{bubbles:!0});r.dispatchEvent(s),window.location.href.includes("publier-trajet")||i(e,t.id),t.dataset.listenerAttached="true"}))}))}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-section");n&&n.remove(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(n,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(n){if(e){document.getElementById(e).style.display="none";var r=document.getElementById("body-content");if(r){if(r.insertAdjacentHTML("beforeend",n.html),c(),o(e,t),t){var s=document.getElementById(t);document.getElementById("add_voiture_marque").value=s.querySelector(".marque").innerHTML}}else console.error("Le container cible n'existe pas : body-content")}})).catch((function(e){return console.error("Erreur:",e)}))}(e,t)}}},e=>{e.O(0,[816,264,28],(()=>{return t=889,e(e.s=t);var t}));e.O()}]);