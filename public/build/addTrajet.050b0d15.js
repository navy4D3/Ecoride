"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[236,468],{540:(e,t,n)=>{var r=n(28),a=n(902);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],u=!0,d=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){d=!0,a=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=document.getElementById("add-trajet-form");c.querySelectorAll("input, select, textarea").forEach((function(e){e.addEventListener("input",(function(){return(0,r.checkInputs)(c)}))})),(0,r.checkInputs)(c);for(var u=document.getElementById("hours"),d=document.getElementById("minutes"),l=document.getElementById("add_trajet_heureDepart"),s=document.getElementById("add_trajet_dateDepart"),v=0;v<24;v++){var m=document.createElement("option");m.value=v.toString().padStart(2,"0"),m.textContent=v.toString().padStart(2,"0"),u.appendChild(m)}for(var f=0;f<60;f+=5){var p=document.createElement("option");p.value=f.toString().padStart(2,"0"),p.textContent=f.toString().padStart(2,"0"),d.appendChild(p)}function y(e){""!==e.value?e.classList.add("valid"):e.classList.remove("valid")}function h(){var e=u.value,t=d.value,n=s.value,r=o(n.split(" "),3),a=r[0],i=r[1],c=r[2],v=parseInt(a,10),m={janvier:0,février:1,mars:2,avril:3,mai:4,juin:5,juillet:6,août:7,septembre:8,octobre:9,novembre:10,décembre:11}[i.toLowerCase()],f=parseInt(c,10);if(void 0===m||isNaN(v)||isNaN(f))console.error("Date invalide :",n);else{var p=new Date(f,m,v,e,t,0).toISOString().slice(0,19);l.value=p}}u.addEventListener("change",(function(){y(this),h()})),d.addEventListener("change",(function(){y(this),h()})),s.addEventListener("change",(function(){h()}));var E=document.getElementById("add_trajet_prixPersonne"),g=document.getElementById("credit-label");E.addEventListener("input",(function(){var e=parseInt(this.value,10);!isNaN(e)&&e>0?g.textContent=1===e?"Crédit":"Crédits":g.textContent=""}));var L=document.getElementById("itineraires-choices"),S=document.getElementById("confirm-itineraire-btn");var I=document.getElementById("continue-btn"),q=document.getElementById("add_trajet_lieuDepart"),B=document.getElementById("add_trajet_lieuArrivee"),b=L.querySelector(".back-btn");I.addEventListener("click",(function(e){var t,n;e.preventDefault(),this.classList.add("inactive"),t=q.value,n=B.value,fetch("/publier-trajet/itineraires?origin=".concat(encodeURIComponent(t),"&destination=").concat(encodeURIComponent(n))).then((function(e){return e.json()})).then((function(e){var t=document.getElementById("itineraires-list");e.forEach((function(e){var n=document.createElement("div");n.dataset.raw=JSON.stringify(e.rawData),n.classList.add("itineraire");var r=e.hasToll?"".concat(e.summary," - Avec péage "):"Sans péage";n.innerHTML="\n                <strong>".concat(r,"</strong>\n                <span>").concat(e.distance," - ").concat(e.duree,"</span>\n            "),t.append(n)})),c.style.display="none",L.style.display="flex",document.querySelector("h1").innerHTML="Choisis un itinéraire",document.querySelectorAll(".itineraire").forEach((function(e){e.addEventListener("click",(function(){document.querySelectorAll(".itineraire").forEach((function(e){return e.classList.remove("selected")})),this.classList.add("selected"),document.getElementById("add_trajet_googleData").value=this.dataset.raw,S.classList.remove("inactive")}))})),I.classList.remove("inactive")})).catch((function(e){console.error("Erreur :",e)}))})),b.addEventListener("click",(function(){c.style.display="flex",L.style.display="none",document.querySelector("h1").innerHTML="Ajouter un trajet",S.classList.add("inactive"),document.querySelectorAll(".itineraire").forEach((function(e){e.remove()}))})),document.getElementById("add-voiture-btn").addEventListener("click",(function(){(0,a.T8)("trajet-details")})),(0,a.d8)();var T=document.getElementById("recapitulatif"),M=T.querySelector(".back-btn");S.addEventListener("click",(function(){document.querySelector("h1").innerHTML="Récapitulatif",T.style.display="flex",L.style.display="none";var e=document.getElementById("add_trajet_lieuDepart"),t=document.getElementById("add_trajet_lieuArrivee"),n=document.getElementById("add_trajet_prixPersonne"),r=T.querySelector(".date-depart"),a=T.querySelector(".lieu-depart"),o=T.querySelector(".heure-depart"),i=T.querySelector(".duree"),c=T.querySelector(".distance"),v=T.querySelector(".heure-arrivee"),m=T.querySelector(".lieu-arrivee"),f=T.querySelector(".voiture-surnom"),p=T.querySelector(".voiture-marque"),y=T.querySelector(".voiture-modele"),h=T.querySelector(".voiture-is-electric"),E=T.querySelector(".voiture-place"),g=T.querySelector(".credits-passager");r.innerHTML="Départ le "+s.value,a.innerHTML=e.value,o.innerHTML=u.value+":"+d.value,m.innerHTML=t.value,g.innerHTML=n.value+" crédits / passager";var S,I,q,B,b,M,H=document.querySelector(".itineraire.selected"),w=JSON.parse(H.dataset.raw),j=w.legs[0].duration.value,_=w.legs[0].distance.text,k=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=t.toString().padStart(2,"0"),a=n.toString().padStart(2,"0");return"".concat(r,":").concat(a)}(j);i.innerHTML=k,c.innerHTML=_,v.innerHTML=(S=l.value,I=j,q=new Date(S),B=new Date(q.getTime()+1e3*I),b=B.getHours().toString().padStart(2,"0"),M=B.getMinutes().toString().padStart(2,"0"),"".concat(b,"h").concat(M));var A=document.querySelector(".voiture-card.selected"),C=A.querySelector(".surnom").innerHTML,x=A.querySelector(".marque").innerHTML,D=A.querySelector(".modele").innerHTML,O=A.querySelector(".is-electric").innerHTML,R=A.querySelector(".places").innerHTML;f.innerHTML=C,p.innerHTML=x,y.innerHTML=D,h.innerHTML=O,E.innerHTML=R})),M.addEventListener("click",(function(){T.style.display="none",L.style.display="flex"}))},902:(e,t,n)=>{n.d(t,{T8:()=>c,d8:()=>i});var r=n(28);function a(){var e=document.getElementById("add_voiture_marque"),t=document.getElementById("suggestions-marque-box"),n=JSON.parse(e.dataset.marqueList);e.addEventListener("input",(function(){var r=this.value.toLowerCase(),a=n.filter((function(e){return e.toLowerCase().includes(r)})).slice(0,10);t.innerHTML="",""!==r&&a.forEach((function(n){var r=document.createElement("li");r.textContent=n,r.style.cursor="pointer",r.onclick=function(){e.value=n,t.innerHTML=""},t.appendChild(r)}))}))}function o(e,t){var n=document.getElementById("add-voiture-section"),c=document.getElementById("add-voiture-form"),u=c.querySelectorAll("input, select, textarea");(0,r.checkInputs)(c),u.forEach((function(e){e.addEventListener("input",(function(){return(0,r.checkInputs)(c)}))})),document.getElementById("add-voiture-back-btn").addEventListener("click",(function(t){document.getElementById("add-voiture-section").style.display="none",document.getElementById(e).style.display="flex"})),document.getElementById("add_voiture_immatriculation").addEventListener("keydown",(function(e){" "===e.key&&e.preventDefault()}));var d=document.getElementById("add_voiture_couleur"),l=document.getElementById("color-view"),s={Blanc:"#ffffff",Noir:"#000000","Gris foncé":"#555555","Gris clair":"#d3d3d3",Rouge:"#ff0000",Bleu:"#0000ff",Vert:"#008000",Jaune:"#ffff00",Orange:"#ffa500",Marron:"#8b4513",Violet:"#800080",Beige:"#f5f5dc",Rose:"#ffc0cb"};function v(){var e=d.value;""===e?d.classList.add("select-color-placeholder"):d.classList.remove("select-color-placeholder"),l.style.backgroundColor=s[e]||"transparent"}d.addEventListener("change",v),v();var m=document.getElementById("add_voiture_places");m.addEventListener("input",(function(){var e=parseInt(this.value,10);isNaN(e)||(e<2?m.value=2:e>9&&(m.value=9))}));var f=document.getElementById("show-delete-voiture-popup");if(f){var p=document.getElementById("delete-voiture-popup"),y=document.getElementById("delete-voiture"),h=document.getElementById("add-voiture-form");f.addEventListener("click",(function(){(0,r.showPopup)(p,"flex")})),y.addEventListener("click",(function(a){a.preventDefault(),fetch("delete-voiture/"+t,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(a){a.status&&"success"==a.status?(document.getElementById(e).style.display="flex",document.getElementById(t).remove(),n.style.display="none",(0,r.showSuccessAlert)("Voiture supprimé avec succès"),i(e,t)):((0,r.treatFormAlert)(h,"",a),(0,r.hidePopup)(p))}))}))}document.getElementById("add-voiture-submit").addEventListener("click",(function(n){n.preventDefault(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-form"),c=new FormData(n),u=document.getElementById("add-voiture-section"),d=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(d,{method:"POST",body:c,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Erreur HTTP : "+e.status);return e.json()})).then((function(n){if(n.status&&"success"==n.status){document.getElementById(e).style.display="flex",u.style.display="none";var c=document.getElementById("user-voitures");if(t){document.getElementById(t).innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),(0,r.showSuccessAlert)("Voiture modifié avec succès")}else{var d=document.createElement("div");d.classList.add("voiture-card"),d.id=n.voiture.id,d.innerHTML='\n                    <span class="surnom">'.concat(n.voiture.surnom,'</span>\n                    <div>\n                        <span class="marque">').concat(n.voiture.marque,'</span>\n                        <span class="modele">').concat(n.voiture.modele,'</span>\n                        <span class="is-electric">').concat(n.voiture.isElectric?"Electrique":"Thermique",'</span>\n                        <span class="places fw-bold">').concat(n.voiture.places," place").concat(n.voiture.places>1?"s":"","</span>\n                    </div>\n                "),c.insertAdjacentElement("afterbegin",d),(0,r.showSuccessAlert)("Voiture ajouté avec succès")}i(e,t);var l=document.getElementById("devenir_chauffeur_hasVoiture"),s=document.querySelectorAll(".voiture-card");l&&s.length>0&&(l.checked=!0,l.dispatchEvent(new Event("input",{bubbles:!0})))}else{var v=document.getElementById("body-content");u.remove(),v.insertAdjacentHTML("beforeend",n.html),o(e,t),a()}}))}(e,t)}))}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.querySelectorAll(".voiture-card"),r=document.querySelector(".voiture-input");t||n.forEach((function(t){"true"!==t.dataset.listenerAttached&&t.addEventListener("click",(function(a){a.preventDefault();var o=t.id;n.forEach((function(e){return e.classList.remove("selected")})),this.classList.add("selected"),r.value=o;var i=new Event("input",{bubbles:!0});r.dispatchEvent(i),window.location.href.includes("publier-trajet")||c(e,t.id),t.dataset.listenerAttached="true"}))}))}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.getElementById("add-voiture-section");n&&n.remove(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t?"/add-voiture?id=".concat(encodeURIComponent(t)):"/add-voiture";fetch(n,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(n){if(e){document.getElementById(e).style.display="none";var r=document.getElementById("body-content");if(r){if(r.insertAdjacentHTML("beforeend",n.html),a(),o(e,t),t){var i=document.getElementById(t);document.getElementById("add_voiture_marque").value=i.querySelector(".marque").innerHTML}}else console.error("Le container cible n'existe pas : body-content")}})).catch((function(e){return console.error("Erreur:",e)}))}(e,t)}}},e=>{e.O(0,[264,28],(()=>{return t=540,e(e.s=t);var t}));e.O()}]);